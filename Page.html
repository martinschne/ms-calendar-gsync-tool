<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <?!= include('Stylesheet'); ?>
  </head>
  <body>
    <main>
      <h1>MS Calendar Transfer Tool</h1>
      <p>
        Fill out the form, press <em>Submit</em> button and allow the app to
        access your Google Calendar. <br />Be aware that the event transfer can
        take a while. <br />Author: Martin Schneider
      </p>
      <form id="request-data-form" onsubmit="handleFormSubmit(this)">
        <label for="bearer-token">Bearer Token:</label>
        <textarea
          id="bearer-token"
          name="bearer-token"
          rows="3"
          placeholder="Enter Bearer Token (e.g., YOUR_TOKEN_HERE)"
          required
        ></textarea>
        <label for="calendar-ids">All Calendar IDs (each on new line):</label>
        <textarea
          id="calendar-ids"
          name="calendar-ids"
          rows="4"
          placeholder="Enter Calendar IDs: each on a new line (Hit Enter after copying an ID)."
          required
        ></textarea>
        <input id="submitBtn" type="submit" value="Submit" />
      </form>
    </main>
    <div id="output"></div>
    <!-- Overlay for blocking interactions during spinner activity -->
    <div class="overlay"></div>
    <!-- Dialog to show synchronisation results -->
    <div class="dialog-container">
      <div id="messageContent"></div>
      <button class="ok-button" onclick="closeDialog()">OK</button>
    </div>
    <!-- Spinner container -->
    <div class="spinner-container">
      <div class="spinner"></div>
      <p class="sync-state">Please wait...</p>
    </div>
    <?!= include('JavaScript'); ?>
  </body>
</html>
